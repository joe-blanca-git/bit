<form [formGroup]="formRegister" (ngSubmit)="onSubmit()">
  <div class="row">
    <!-- Nome Completo -->
    <div class="col-12 col-sm-6 mb-3">
      <label for="name" class="form-label">Nome Completo</label>
      <input
        type="text"
        id="name"
        formControlName="name"
        class="form-control"
        [ngClass]="{
          'is-invalid': (f['name'].touched || submitted) && f['name'].invalid,
          'is-valid': (f['name'].touched || submitted) && f['name'].valid
        }"
        required
      />
      <div class="valid-feedback"></div>
      <div class="invalid-feedback" *ngIf="f['name'].errors?.['required']">
        Seu nome é uma informação obrigatória!
      </div>
    </div>

    <!-- CPF -->
    <div class="col-12 col-sm-3 mb-3">
      <label for="document" class="form-label">CPF</label>
      <input
        type="text"
        id="document"
        formControlName="document"
        class="form-control"
        mask="000.000.000-00"
        [dropSpecialCharacters]="false"
        [ngClass]="{
          'is-invalid':
            (f['document'].touched || submitted) && f['document'].invalid,
          'is-valid':
            (f['document'].touched || submitted) && f['document'].valid
        }"
        required
      />
      <div class="valid-feedback">CPF Válido</div>
      <div class="invalid-feedback" *ngIf="f['document'].errors?.['required']">
        Seu CPF é uma informação obrigatória!
      </div>
      <div class="invalid-feedback" *ngIf="f['document'].errors?.['documentInvalid']">
        CPF inválido!
      </div>
      <div class="invalid-feedback" *ngIf="f['document'].errors?.['documentExisting']">
        Este CPF já está cadastrado!
      </div>
    </div>

    <!-- Fone -->
    <div class="col-12 col-sm-3 mb-3">
      <label for="phone" class="form-label">Fone</label>
      <input
        type="text"
        id="phone"
        formControlName="phone"
        class="form-control"
        mask="(00) [0]0000-0000"
        [dropSpecialCharacters]="false"
        [ngClass]="{
          'is-invalid': (f['phone'].touched || submitted) && f['phone'].invalid,
          'is-valid': (f['phone'].touched || submitted) && f['phone'].valid
        }"
        required
      />
      <div class="valid-feedback"></div>
      <div class="invalid-feedback" *ngIf="f['phone'].errors?.['required']">
        Seu Telefone de contato é uma informação obrigatória!
      </div>
    </div>

    <!-- E-mail (Username) -->
    <div class="col-12 col-sm-4 mb-3">
      <label for="email" class="form-label">E-mail</label>
      <input
        type="email"
        id="email"
        formControlName="email"
        class="form-control"
        [ngClass]="{
          'is-invalid': (f['email'].touched || submitted) && f['email'].invalid,
          'is-valid': (f['email'].touched || submitted) && f['email'].valid
        }"
        required
      />
      <div class="valid-feedback">E-mail válido!</div>
      <div class="invalid-feedback" *ngIf="f['email'].errors?.['required']">
        O e-mail é obrigatório.
      </div>
      <div class="invalid-feedback" *ngIf="f['email'].errors?.['email']">
        O e-mail deve ser válido.
      </div>
      <div class="invalid-feedback" *ngIf="f['email'].errors?.['emailExisting']">
        Este e-mail já está cadastrado!
      </div>
    </div>

    <!-- Senha -->
    <div class="col-12 col-sm-4 mb-3">
      <label for="password" class="form-label">Senha</label>
      <input
        type="password"
        id="password"
        formControlName="password"
        class="form-control"
        [ngClass]="{
          'is-invalid': (f['password'].touched || submitted) && f['password'].invalid,
          'is-valid': (f['password'].touched || submitted) && f['password'].valid
        }"
        required
      />
      <div class="valid-feedback">Senha forte!</div>
      <div class="invalid-feedback" *ngIf="f['password'].errors?.['required']">
        A senha é obrigatória.
      </div>
      <div class="invalid-feedback" *ngIf="f['password'].errors?.['minlength']">
        A senha deve ter no mínimo 8 caracteres.
      </div>
      <!-- Mensagens de Força da Senha -->
      <div class="invalid-feedback" *ngIf="f['password'].errors?.['passwordStrength'] && (f['password'].touched || submitted)">
        A senha deve conter:
        <ul class="mb-0 ps-3">
          <li [class.text-success]="f['password'].errors?.['passwordStrength'].hasUpperCase">
            1 Letra Maiúscula
          </li>
          <li [class.text-success]="f['password'].errors?.['passwordStrength'].hasLowerCase">
            1 Letra Minúscula
          </li>
          <li [class.text-success]="f['password'].errors?.['passwordStrength'].hasNumeric">
            1 Número
          </li>
        </ul>
      </div>
    </div>

    <!-- Confirmar Senha -->
    <div class="col-12 col-sm-4 mb-3">
      <label for="passwordConfirmation" class="form-label">Confirmar Senha</label>
      <input
        type="password"
        id="passwordConfirmation"
        formControlName="passwordConfirmation"
        class="form-control"
        [ngClass]="{
          'is-invalid': (f['passwordConfirmation'].touched || submitted) && f['passwordConfirmation'].invalid,
          'is-valid': (f['passwordConfirmation'].touched || submitted) && f['passwordConfirmation'].valid
        }"
        required
      />
      <div class="valid-feedback">Senhas conferem!</div>
      <div class="invalid-feedback" *ngIf="f['passwordConfirmation'].errors?.['required']">
        A confirmação de senha é obrigatória.
      </div>
      <div class="invalid-feedback" *ngIf="f['passwordConfirmation'].errors?.['passwordMismatch']">
        As senhas não conferem!
      </div>
    </div>

    <!-- Data de Nascimento -->
    <div class="col-12 col-sm-3 mb-3">
      <label for="dtBirth" class="form-label">Data de Nascimento</label>
      <input
        type="text"
        id="dtBirth"
        formControlName="dtBirth"
        class="form-control"
        mask="00/00/0000"
        [ngClass]="{
          'is-invalid': (f['dtBirth'].touched || submitted) && f['dtBirth'].invalid,
          'is-valid': (f['dtBirth'].touched || submitted) && f['dtBirth'].valid
        }"
        required
      />
      <div class="invalid-feedback" *ngIf="f['dtBirth'].errors?.['required']">
        Data de nascimento é obrigatória.
      </div>
    </div>

    <!-- CEP -->
    <div class="col-12 col-sm-2 mb-3">
      <label for="cep" class="form-label">CEP</label>
      <input
        type="text"
        id="cep"
        formControlName="cep"
        class="form-control"
        mask="00000-000"
        [ngClass]="{
          'is-invalid': (f['cep'].touched || submitted) && f['cep'].invalid,
          'is-valid': (f['cep'].touched || submitted) && f['cep'].valid
        }"
        required
      />
      <div class="invalid-feedback" *ngIf="f['cep'].errors?.['required']">
        CEP é obrigatório.
      </div>
    </div>

    <!-- Endereço -->
    <div class="col-12 col-sm-7 mb-3">
      <label for="address" class="form-label">Endereço Completo</label>
      <input
        type="text"
        id="address"
        formControlName="address"
        class="form-control"
        placeholder="Ex: Rua, Número, Bairro, Complemento"
        [ngClass]="{
          'is-invalid': (f['address'].touched || submitted) && f['address'].invalid,
          'is-valid': (f['address'].touched || submitted) && f['address'].valid
        }"
        required
      />
      <div class="invalid-feedback" *ngIf="f['address'].errors?.['required']">
        Endereço é obrigatório.
      </div>
    </div>

    <!-- Estado -->
    <div class="col-12 col-sm-3 mb-3">
      <label for="idState" class="form-label">Estado</label>
      <select
        id="idState"
        formControlName="idState"
        class="form-select"
        [ngClass]="{
          'is-invalid': (f['idState'].touched || submitted) && f['idState'].invalid,
          'is-valid': (f['idState'].touched || submitted) && f['idState'].valid
        }"
        required
      >
        <option value="" disabled>Selecione um estado...</option>
        <option *ngFor="let state of states" [value]="state.id">{{ state.name }}</option>
      </select>
      <div class="invalid-feedback" *ngIf="f['idState'].errors?.['required']">
        Estado é obrigatório.
      </div>
    </div>

    <!-- Cidade -->
    <div class="col-12 col-sm-4 mb-3">
      <label for="idCity" class="form-label">Cidade</label>
      <select
        id="idCity"
        formControlName="idCity"
        class="form-select"
        [disabled]="!f['idState'].value"
        [ngClass]="{
          'is-invalid': (f['idCity'].touched || submitted) && f['idCity'].invalid,
          'is-valid': (f['idCity'].touched || submitted) && f['idCity'].valid
        }"
        required
      >
        <option value="" disabled>Selecione uma cidade...</option>
        <option *ngFor="let city of cities" [value]="city.id">{{ city.name }}</option>
      </select>
      <div class="invalid-feedback" *ngIf="f['idCity'].errors?.['required']">
        Cidade é obrigatória.
      </div>
    </div>

    <div class="col-sm-3 d-none d-sm-block"></div>
    <!-- Tipo de Usuário -->
    <div class="col-12 col-sm-3 mb-3 d-flex align-items-start flex-column">
      <label class="form-label d-block">Tipo de Usuário</label>
      <div class="form-check-inline">
        <input
          class="form-check-input"
          type="radio"
          id="selfEmployed"
          value="self"
          formControlName="userType"
        />
        <label class="form-check-label" for="selfEmployed">
          Profissional Autônomo
        </label>
      </div>
      <div class="form-check-inline">
        <input
          class="form-check-input"
          type="radio"
          id="company"
          value="company"
          formControlName="userType"
        />
        <label class="form-check-label" for="company">Empresa</label>
      </div>
    </div>

    <!-- Nome da Empresa (Condicional) -->
    <div class="col-12 col-sm-8 col-sm-4 mb-3" *ngIf="selectedUserType === 'company'">
      <label for="nameCompany" class="form-label">Nome da Empresa</label>
      <input
        type="text"
        id="nameCompany"
        formControlName="nameCompany" 
        class="form-control"
        [ngClass]="{
          'is-invalid':
            (f['nameCompany'].touched || submitted) && f['nameCompany'].invalid,
          'is-valid':
            (f['nameCompany'].touched || submitted) && f['nameCompany'].valid
        }"
      />
      <div class="valid-feedback"></div>
      <div class="invalid-feedback" *ngIf="f['nameCompany'].errors?.['required']">
        O Nome da sua empresa é uma informação obrigatória!
      </div>
    </div>

    <!-- Botão de Submit -->
    <div class="col-12 text-end mt-3">
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="formRegister.pending"
      >
        <span *ngIf="!formRegister.pending">Cadastrar</span>
        <span *ngIf="formRegister.pending" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        <span *ngIf="formRegister.pending"> Validando...</span>
      </button>
    </div>

  </div>
</form>